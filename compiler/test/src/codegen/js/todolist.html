<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Todo List</title>
    <style>
        :root{
            --bg:#0f1724;
            --card:#0b1220;
            --muted:#95a3b8;
            --accent:#60a5fa;
            --accent-2:#7c3aed;
            --ok:#34d399;
            --danger:#fb7185;
            --glass: rgba(255,255,255,0.03);
            --radius:12px;
            color-scheme: dark;
            font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }
        html,body{height:100%; margin:0; background:linear-gradient(180deg,#071029 0%, #071c2b 100%); color:#e6eef8;}
        .wrap{
            max-width:760px;
            margin:40px auto;
            padding:28px;
            background:linear-gradient(180deg,var(--card), rgba(11,18,32,0.9));
            border-radius:var(--radius);
            box-shadow: 0 8px 30px rgba(2,8,23,0.6);
            backdrop-filter: blur(6px);
        }

        header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
        header h1{font-size:20px;margin:0;}
        header p{margin:0;color:var(--muted);font-size:13px}

        .input-row{display:flex;gap:8px;margin-bottom:16px}
        .input-row input[type="text"]{
            flex:1;
            padding:12px 14px;
            border-radius:10px;
            border:1px solid rgba(255,255,255,0.04);
            background:var(--glass);
            color:inherit;
            font-size:15px;
            outline:none;
        }
        .input-row input[type="text"]::placeholder{color:var(--muted)}
        .btn{
            padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(180deg,var(--accent),#3b82f6);color:white;font-weight:600;cursor:pointer;
            box-shadow: 0 4px 10px rgba(59,130,246,0.15);
        }
        .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);box-shadow:none}

        .controls{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:12px}
        /* .filters{display:flex;gap:8px}
        .filters button{background:transparent;border:0;padding:6px 8px;border-radius:8px;color:var(--muted);cursor:pointer}
        .filters button.active{background:rgba(255,255,255,0.03);color:var(--accent)} */

        .list{list-style:none;padding:0;margin:0;display:grid;gap:8px}
        .item{
            display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);
        }
        .item .chk{
            width:18px;height:18px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);display:inline-grid;place-items:center;cursor:pointer;
        }
        .item .chk.checked{background:linear-gradient(180deg,var(--ok),#10b981);border:0;color:#042014}
        .item .text{flex:1;font-size:15px;word-break:break-word}
        .item .text.done{text-decoration:line-through;color:var(--muted)}
        .item button.icon{border:0;background:transparent;color:var(--muted);cursor:pointer;padding:6px;border-radius:8px}
        .item button.icon:hover{background:rgba(255,255,255,0.02)}

        .meta{display:flex;align-items:center;gap:12px;color:var(--muted);font-size:13px;margin-top:12px}
        .clear{color:var(--danger);cursor:pointer;border:0;background:transparent}

        /* small screens */
        @media (max-width:520px){
            .wrap{margin:24px;padding:18px}
            header h1{font-size:18px}
        }

        /* tiny focus styles for keyboard accessibility */
        :focus{outline: 3px solid rgba(96,165,250,0.12); outline-offset:3px}
        input:focus, button:focus { box-shadow: 0 4px 24px rgba(96,165,250,0.06); }
    </style>
</head>
<body>
<main class="wrap" role="main" aria-labelledby="title">
    <header>
        <div>
            <h1 id="title">Todo List</h1>
            <p>Create tasks, toggle, edit, and persist locally.</p>
        </div>
        <div style="margin-left:auto;color:var(--muted);font-size:13px" id="count">0 items</div>
    </header>

    <div class="input-row" role="region" aria-label="Add todo">
        <input id="todoInput" type="text" placeholder="What do you want to do?" aria-label="New todo">
        <button id="addBtn" class="btn" title="Add (Enter)">Add</button>
    </div>

    <!-- <div class="controls">
        <div class="filters" role="tablist" aria-label="Filter todos">
            <button class="filter active" data-filter="all" role="tab" aria-selected="true">All</button>
            <button class="filter" data-filter="active" role="tab" aria-selected="false">Active</button>
            <button class="filter" data-filter="completed" role="tab" aria-selected="false">Completed</button>
        </div>

        <div>
            <button id="clearCompleted" class="btn ghost" title="Clear completed">Clear completed</button>
        </div>
    </div> -->

    <ul id="todoList" class="list" aria-live="polite"></ul>

    <div class="meta">
        <div id="leftCount">0 active</div>
        <div style="margin-left:auto;color:var(--muted)">Tip: Double-click a todo to edit it</div>
    </div>
</main>
<script type="module">
  //   import { rt$$NativeRuntime } from '../rt-js/NativeRuntime.js';
  //   import { todolist$$App_0 } from './todolist/App_0.js';
  //   rt$$NativeRuntime.ensureWasm();
  //   todolist$$App_0.$self.$hash$imm$1(null);
  const input  = document.getElementById("todoInput");
  const addBtn = document.getElementById("addBtn");
  const list   = document.getElementById("todoList");
  // const clear  = document.getElementById("clearCompleted");
  // const filters = Array.from(document.querySelectorAll(".filter"));

  let filter = "all"; // "all" | "active" | "completed"

  // ─── Event wiring ─────────────────────────────
  addBtn.onclick = addTask;
  input.onkeydown = e => { if (e.key === "Enter") addTask(); };
  // clear.onclick = clearCompleted;
  // filters.forEach(b => b.addEventListener("click", () => setFilter(b.dataset.filter)));

  // ─── Core logic ─────────────────────────────
  function addTask() {
    const text = input.value.trim();
    if (!text) return;

    const li = document.createElement("li");
    li.className = "item";
    li.dataset.done = "false";

    // ✅ checkbox
    const chk = document.createElement("button");
    chk.className = "chk";
    chk.title = "Mark done";
    chk.textContent = "";
    chk.onclick = () => toggle(li, chk, span);

    // text span
    const span = document.createElement("div");
    span.className = "text";
    span.textContent = text;
    span.ondblclick = () => startEdit(li, span);

    // delete button
    const delBtn = document.createElement("button");
    delBtn.textContent = "✕";
    delBtn.className = "icon";
    delBtn.onclick = () => li.remove();

    // assemble
    li.append(chk, span, delBtn);
    list.appendChild(li);

    input.value = "";
    input.focus();
    // applyFilter();
  }

  function toggle(li, chk, span) {
    const done = li.dataset.done === "true";
    li.dataset.done = (!done).toString();

    chk.classList.toggle("checked", !done);
    chk.textContent = done ? "" : "✓";
    span.classList.toggle("done", !done);

    // applyFilter();
  }

  // function clearCompleted() {
  //   const items = Array.from(list.children);
  //   items.forEach(li => {
  //     if (li.dataset.done === "true") li.remove();
  //   });
  // }

  function startEdit(li, span) {
    const oldText = span.textContent;
    const input = document.createElement("input");
    input.type = "text";
    input.value = oldText;
    input.className = "text";
    input.style.flex = "1";
    li.replaceChild(input, span);
    input.focus();
    input.select();

    function finish(save) {
      if (save) {
        const v = input.value.trim();
        span.textContent = v || oldText;
      }
      li.replaceChild(span, input);
    }

    input.addEventListener("keydown", e => {
      if (e.key === "Enter") finish(true);
      if (e.key === "Escape") finish(false);
    });
    input.addEventListener("blur", () => finish(true));
  }

  // ─── Filtering ─────────────────────────────
  // function setFilter(f) {
  //   filter = f;
  //   filters.forEach(btn => {
  //     const active = btn.dataset.filter === f;
  //     btn.classList.toggle("active", active);
  //     btn.setAttribute("aria-selected", active ? "true" : "false");
  //   });
  //   applyFilter();
  // }

  // function applyFilter() {
  //   const items = Array.from(list.children);
  //   items.forEach(li => {
  //     const done = li.dataset.done === "true";
  //     const show =
  //       filter === "all" ||
  //       (filter === "active" && !done) ||
  //       (filter === "completed" && done);
  //     li.style.display = show ? "" : "none";
  //   });
  // }
</script>
</body>
</html>
